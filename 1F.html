<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2024 vs 2025 生產數據分析報告 (1F)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- 引入 DataLabels 插件 -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f3f4f6; }
        .card { background: white; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); padding: 20px; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-gray-800">1F 生產數據比較分析報告</h1>
            <p class="text-gray-600 mt-2">比較區間：2024 全年 vs 2025 全年 | 資料來源：總表(2024/2025) - 1F</p>
        </header>

        <!-- KPI Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="card border-l-4 border-blue-500">
                <h3 class="text-sm text-gray-500 font-medium">2024 總產量</h3>
                <p class="text-3xl font-bold text-gray-800 mt-1">116,110</p>
                <span class="text-xs text-gray-400">件/年</span>
            </div>
            <div class="card border-l-4 border-emerald-500">
                <h3 class="text-sm text-gray-500 font-medium">2025 總產量</h3>
                <p class="text-3xl font-bold text-gray-800 mt-1">108,544</p>
                <span class="text-xs text-red-500 font-bold">▼ 6.5% (較去年)</span>
            </div>
            <div class="card border-l-4 border-purple-500">
                <h3 class="text-sm text-gray-500 font-medium">最大變化類別 (小謝籃)</h3>
                <p class="text-3xl font-bold text-gray-800 mt-1">-4,744</p>
                <span class="text-xs text-red-500">件數減少 (跌幅 32.4%)</span>
            </div>
        </div>

        <!-- Charts Row 1: Category Comparison -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <div class="card">
                <h2 class="text-xl font-bold text-gray-800 mb-4">各產品類別年度產量對比</h2>
                <canvas id="categoryChart"></canvas>
                <p class="text-sm text-gray-500 mt-4 text-center">整體產量微幅下滑，唯獨「水平儀」呈現顯著正成長。</p>
            </div>
            <div class="card">
                <h2 class="text-xl font-bold text-gray-800 mb-4">2025 年產品佔比分佈</h2>
                <div class="h-64 flex justify-center">
                    <canvas id="pieChart"></canvas>
                </div>
                <p class="text-sm text-gray-500 mt-4 text-center">「吸盤」與「小脫磁」為 1F 主力產品，合計佔總產能約 58%。</p>
            </div>
        </div>

        <!-- Charts Row 2: Monthly Trend -->
        <div class="card mb-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800">每月總產量趨勢 (2024 vs 2025)</h2>
            </div>
            <div class="h-80">
                <canvas id="trendChart"></canvas>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6 text-sm text-gray-600 bg-gray-50 p-4 rounded-lg">
                <div>
                    <strong class="text-blue-600">2024 特徵：</strong> 
                    產能分佈較為平均，但在 5月 (1.4萬件) 與 11月 (1.2萬件) 出現雙高峰，年底 12月 依然維持高檔。
                </div>
                <div>
                    <strong class="text-emerald-600">2025 特徵：</strong> 
                    呈現明顯的「夏季集中」趨勢，7月與8月爆發性成長（達 1.3~1.4萬件），但第 4 季（10-12月）產能顯著低於去年同期。
                </div>
            </div>
        </div>

        <!-- Detailed Analysis Text -->
        <div class="card bg-slate-50 border border-slate-200">
            <h2 class="text-xl font-bold text-gray-800 mb-4">綜合分析報告</h2>
            <div class="prose max-w-none text-gray-700 space-y-4">
                <p>
                    <strong>1. 產品消長與主力轉移：</strong>
                    雖然整體產量下滑 6.5%，但<strong>「水平儀」</strong>表現亮眼，年成長達 <strong>33.3%</strong>，顯示該產品線需求強勁。反觀<strong>「小謝籃」</strong>產量大幅縮減 (-32.4%)，需確認是否為訂單流失或庫存調整策略。
                </p>
                <p>
                    <strong>2. 產能季節性波動劇烈：</strong>
                    2025 年的生產節奏與 2024 年截然不同。2025 年集中火力在 <strong>7-8 月</strong>（主要由「吸盤」與「小脫磁」帶動），單月產出突破 1.4 萬件。然而，進入 Q4 後產能快速冷卻，特別是 11 月僅產出 3,912 件（去年同期為 1.2 萬件），波動幅度極大。
                </p>
                <p>
                    <strong>3. 核心產品依賴度：</strong>
                    <strong>「吸盤」</strong> (33,060件) 與 <strong>「小脫磁」</strong> (29,860件) 依然是 1F 的絕對主力，佔總產量的近六成。維持這兩項產品的良率與訂單穩定性，對 1F 的整體績效至關重要。
                </p>
            </div>
        </div>
    </div>

    <script>
        // Register the DataLabels plugin globally
        Chart.register(ChartDataLabels);

        // Data Extraction from PDF contents (1F Data)
        const categories = ["馬蹄型", "小脫磁", "小謝籃", "POWER WORKER", "吸盤", "水平儀"];
        
        // 2024 Raw Data (1F)
        const raw2024 = {
            "馬蹄型": [1201, 1600, 1008, 360, 4368, 1912, 1008, 1484, 2504, 840, 1212, 2118],
            "小脫磁": [2873, 2424, 3060, 3060, 1404, 2004, 3960, 2628, 1812, 1764, 5796, 1104],
            "小謝籃": [0, 2248, 1008, 1320, 504, 312, 2160, 408, 4312, 1752, 600, 0],
            "POWER WORKER": [480, 300, 660, 400, 1860, 200, 0, 700, 480, 480, 0, 0],
            "吸盤": [3862, 500, 0, 4410, 5108, 500, 2214, 3048, 1200, 3852, 2024, 8632],
            "水平儀": [0, 0, 864, 1296, 864, 0, 2880, 0, 144, 0, 3024, 0]
        };

        // 2025 Raw Data (1F)
        const raw2025 = {
            "馬蹄型": [1708, 804, 2106, 1660, 2760, 1704, 660, 3058, 2064, 0, 1704, 0],
            "小脫磁": [1008, 3804, 3856, 1500, 1368, 3132, 2928, 5112, 1188, 2532, 1608, 1824],
            "小謝籃": [0, 1728, 240, 504, 2520, 504, 504, 1816, 1056, 504, 0, 504],
            "POWER WORKER": [1000, 300, 480, 0, 0, 1000, 500, 1560, 60, 0, 0, 520],
            "吸盤": [1514, 2408, 1700, 1148, 2000, 2306, 8600, 2710, 2870, 2204, 600, 5000],
            "水平儀": [3024, 0, 3024, 0, 3024, 0, 0, 0, 3024, 0, 0, 0]
        };

        // Calculate Category Totals
        const totals2024 = categories.map(cat => raw2024[cat].reduce((a, b) => a + b, 0));
        const totals2025 = categories.map(cat => raw2025[cat].reduce((a, b) => a + b, 0));

        // Calculate Monthly Totals (Aggregated)
        const monthlyTotals2024 = Array(12).fill(0).map((_, monthIdx) => 
            categories.reduce((sum, cat) => sum + raw2024[cat][monthIdx], 0)
        );
        const monthlyTotals2025 = Array(12).fill(0).map((_, monthIdx) => 
            categories.reduce((sum, cat) => sum + raw2025[cat][monthIdx], 0)
        );

        // Chart 1: Category Comparison (Bar)
        const ctxCategory = document.getElementById('categoryChart').getContext('2d');
        new Chart(ctxCategory, {
            type: 'bar',
            data: {
                labels: categories,
                datasets: [
                    {
                        label: '2024 年產量',
                        data: totals2024,
                        backgroundColor: 'rgba(59, 130, 246, 0.6)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 1,
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            offset: -2
                        }
                    },
                    {
                        label: '2025 年產量',
                        data: totals2025,
                        backgroundColor: 'rgba(16, 185, 129, 0.6)',
                        borderColor: 'rgba(16, 185, 129, 1)',
                        borderWidth: 1,
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            offset: -2
                        }
                    }
                ]
            },
            options: {
                responsive: true,
                layout: {
                    padding: { top: 25 }
                },
                plugins: {
                    legend: { position: 'top' },
                    datalabels: {
                        color: '#444',
                        font: { weight: 'bold', size: 10 },
                        formatter: function(value) {
                            return value.toLocaleString();
                        }
                    },
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                let idx = context.dataIndex;
                                let v24 = totals2024[idx];
                                let v25 = totals2025[idx];
                                if(context.datasetIndex === 1) { 
                                    let diff = ((v25 - v24) / v24 * 100).toFixed(1);
                                    return `YoY 變化: ${diff}%`;
                                }
                            }
                        }
                    }
                }
            }
        });

        // Chart 2: 2025 Distribution (Pie)
        const ctxPie = document.getElementById('pieChart').getContext('2d');
        new Chart(ctxPie, {
            type: 'doughnut',
            data: {
                labels: categories,
                datasets: [{
                    data: totals2025,
                    backgroundColor: [
                        '#3B82F6', '#EF4444', '#F59E0B', '#6366F1', '#10B981', '#8B5CF6'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'right' },
                    datalabels: {
                        color: '#fff',
                        font: { weight: 'bold', size: 11 },
                        formatter: function(value, context) {
                            let total = context.chart._metasets[context.datasetIndex].total;
                            let percentage = (value / total * 100).toFixed(1) + "%";
                            if (value > 2000) { 
                                return value.toLocaleString() + '\n' + percentage;
                            } else {
                                return null;
                            }
                        }
                    }
                }
            }
        });

        // Chart 3: Monthly Trend (Line)
        const months = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
        const ctxTrend = document.getElementById('trendChart').getContext('2d');
        new Chart(ctxTrend, {
            type: 'line',
            data: {
                labels: months,
                datasets: [
                    {
                        label: '2024 總產量',
                        data: monthlyTotals2024,
                        borderColor: '#3B82F6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: '2025 總產量',
                        data: monthlyTotals2025,
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.3,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    datalabels: { display: false }
                },
                interaction: {
                    mode: 'index',
                    intersect: false,
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: '產量 (件)' }
                    }
                }
            }
        });
    </script>
</body>
</html>
